<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TaiLovesyouu</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="TaiLovesyou2026">

<!-- SUPABASE -->
<script src="https://unpkg.com/@supabase/supabase-js@2"></script>

<style>
:root {
  --accent: #a855f7;
  --bg1: #0b0b14;
  --bg2: #050508;
  --glass-bg: rgba(255,255,255,0.08);
  --glass-border: rgba(255,255,255,0.18);
  --blur: 18px;
  --radius: 20px;
  --anim: 0.25s;
}

* { box-sizing: border-box; font-family: Inter, sans-serif; }
body {
  margin: 0; min-height: 100vh;
  background: radial-gradient(circle at top, var(--bg1), var(--bg2));
  color: white; overflow-x: hidden;
}
body::after {
  content: "TaiLovesyou2026"; position: fixed;
  bottom: 10px; right: 14px; opacity: 0.15; font-size: 12px;
  pointer-events: none;
}
.glass {
  background: var(--glass-bg);
  backdrop-filter: blur(var(--blur));
  -webkit-backdrop-filter: blur(var(--blur));
  border: 1px solid var(--glass-border);
  border-radius: var(--radius);
  box-shadow: 0 0 35px rgba(0,0,0,.6);
}
header { margin:20px; padding:20px; }
header h1 { margin:0; font-size:26px; }
nav { display:flex; gap:10px; margin-top:10px; }
nav button {
  padding:8px 14px; border-radius:14px; border:none;
  background: rgba(255,255,255,0.1); color:white; cursor:pointer;
  transition: var(--anim);
}
nav button:hover { background: var(--accent); }
main { padding:20px; }
.page { display:none; animation: fade var(--anim) ease; }
.page.active { display:block; }
@keyframes fade { from{opacity:0; transform:translateY(8px);} to{opacity:1; transform:none;} }
#login { max-width:400px; margin:15vh auto; padding:25px; }
#login input { width:100%; margin-bottom:12px; padding:12px; border-radius:14px; border:none; outline:none; }
#notesGrid { display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:15px; }
.note { padding:14px; }
.note textarea { width:100%; height:140px; background:transparent; border:none; color:white; resize:none; outline:none; }
.setting { margin-bottom:16px; }
.setting label { font-size:13px; opacity:.8; display:block; margin-bottom:4px; }
.setting input[type="range"], .setting input[type="color"] { width:100%; }
.chatMsg { font-size:13px; margin-bottom:6px; opacity:.9; }
#chatBox { max-height:250px; overflow-y:auto; margin-bottom:10px; }
</style>
</head>

<body>

<!-- LOGIN -->
<div id="login" class="glass">
  <h2>ðŸ’œ TaiLovesyouu</h2>
  <p>Email:</p>
  <input id="email" placeholder="Email">
  <p>Password:</p>
  <input id="pass" type="password" placeholder="Password">
  <p>Username (register only):</p>
  <input id="username" placeholder="Username">
  <button onclick="registerUser()">Register</button>
  <button onclick="loginUser()">Login</button>
  <p style="margin-top:10px;font-size:12px;opacity:0.7;">Site access password: tailovesyou</p>
</div>

<!-- APP -->
<div id="app">
  <header class="glass">
    <h1>TaiLovesyouu</h1>
    <nav>
      <button onclick="go('notes')">Notes</button>
      <button onclick="go('chat')">Chat</button>
      <button onclick="go('settings')">Settings</button>
      <button onclick="go('profile')">Profile</button>
      <button onclick="go('proPage')">Pro</button>
      <button onclick="go('staffPage')">Staff</button>
    </nav>
  </header>

  <main>

    <!-- NOTES -->
    <section id="notes" class="page glass">
      <h2>Notes</h2>
      <button onclick="addNote()">âž• New Note</button>
      <div id="notesGrid"></div>
    </section>

    <!-- CHAT -->
    <section id="chat" class="page glass">
      <h2>Chat</h2>
      <div id="chatBox"></div>
      <input id="chatInput" placeholder="Say somethingâ€¦" onkeydown="sendChat(event)">
    </section>

    <!-- SETTINGS -->
    <section id="settings" class="page glass">
      <h2>Settings</h2>
      <div class="setting">
        <label>Accent Color</label>
        <input type="color" onchange="setVar('--accent', this.value)">
      </div>
      <div class="setting">
        <label>Glass Blur</label>
        <input type="range" min="5" max="40" value="18" oninput="setVar('--blur', this.value+'px')">
      </div>
      <div class="setting">
        <label>Border Radius</label>
        <input type="range" min="10" max="40" value="20" oninput="setVar('--radius', this.value+'px')">
      </div>
      <div class="setting">
        <label>Unlock Role (Pro/Staff)</label>
        <input id="rolePass" placeholder="Password">
        <button onclick="unlockRole(document.getElementById('rolePass').value)">Unlock</button>
      </div>
    </section>

    <!-- PROFILE -->
    <section id="profile" class="page glass">
      <h2>Profile</h2>
      <p>Username: <b id="profileName"></b></p>
      <p>Role: <b id="role">User</b></p>
    </section>

    <!-- PRO PAGE -->
    <section id="proPage" class="page glass">
      <h2>Pro Tools</h2>
      <p>Only visible if Pro or Staff</p>
    </section>

    <!-- STAFF PAGE -->
    <section id="staffPage" class="page glass">
      <h2>Staff Panel</h2>
      <p>Only visible if Staff</p>
    </section>

  </main>
</div>

<script>
const SUPABASE_URL = "https://briwvcsduzssmjipxupb.supabase.co";
const SUPABASE_KEY = "sb_publishable_KXEckjdTYLzecNnacueLaA_JU8dUceV";
const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

let currentUser = null;
let currentProfile = null;
let role = "user";
let notes = [];

// ================= LOGIN / REGISTER =================
async function registerUser() {
  const email = document.getElementById('email').value;
  const pass = document.getElementById('pass').value;
  const username = document.getElementById('username').value;

  if(!email || !pass || !username) return alert("Fill all fields");

  const { data, error } = await supabase.auth.signUp({ email, password: pass });
  if(error) return alert(error.message);

  await supabase.from("profiles").insert({ id: data.user.id, username, role: "user" });
  alert("Account created! Login now.");
}

async function loginUser() {
  const email = document.getElementById('email').value;
  const pass = document.getElementById('pass').value;

  if(!email || !pass) return alert("Fill all fields");

  const { data, error } = await supabase.auth.signInWithPassword({ email, password: pass });
  if(error) return alert(error.message);

  currentUser = data.user;
  await loadProfile();
  login.style.display="none";
  app.style.display="block";
  go("notes");
}

// ================= PROFILE =================
async function loadProfile() {
  const { data } = await supabase.from("profiles").select("*").eq("id", currentUser.id).single();
  currentProfile = data;
  role = data.role;
  document.getElementById("role").textContent = role;
  document.getElementById("profileName").textContent = data.username;
  renderNotes();
}

// ================= NOTES =================
async function loadNotes() {
  if(!currentUser) return;
  const { data } = await supabase.from("notes").select("*").eq("user_id", currentUser.id).order("pinned", {ascending:false});
  notes = data || [];
  renderNotes();
}

function renderNotes() {
  notesGrid.innerHTML="";
  notes.forEach((t,i)=>{
    const n=document.createElement("div"); n.className="note glass";
    const ta=document.createElement("textarea"); ta.value=t.content || ""; 
    ta.oninput=async ()=>{
      t.content=ta.value;
      await supabase.from("notes").upsert({id:t.id, user_id:currentUser.id, content:t.content});
    };
    n.appendChild(ta);
    notesGrid.appendChild(n);
  });
}

async function addNote() {
  if(!currentUser) return alert("Login first");
  const { data } = await supabase.from("notes").insert({user_id:currentUser.id, content:""}).select().single();
  notes.push(data);
  renderNotes();
}

// ================= CHAT =================
chatInput.addEventListener("keydown", async (e)=>{
  if(e.key!=="Enter") return;
  const msg = e.target.value;
  if(!msg) return;
  await supabase.from("messages").insert({user_id:currentUser.id, message:msg});
  const d=document.createElement("div"); d.className="chatMsg"; d.textContent="You: "+msg; chatBox.appendChild(d);
  e.target.value="";
});

// ================= SETTINGS =================
function setVar(name,val){document.documentElement.style.setProperty(name,val);}
async function unlockRole(pass){
  let newRole=null;
  if(pass==="taiwantshuzz") newRole="pro";
  if(pass==="cuhlove") newRole="staff";
  if(!newRole) return alert("Wrong password");
  await supabase.from("profiles").update({role:newRole}).eq("id",currentUser.id);
  role=newRole; document.getElementById("role").textContent=role;
  alert("Unlocked role: "+newRole);
}

// ================= SPA ROUTING =================
function go(id){document.querySelectorAll(".page").forEach(p=>p.classList.remove("active")); document.getElementById(id).classList.add("active");}

// ================= LAST ACTIVE =================
setInterval(async ()=>{
  if(!currentUser) return;
  await supabase.from("profiles").update({last_active:new Date()}).eq("id",currentUser.id);
},60000);

</script>
</body>
</html>
